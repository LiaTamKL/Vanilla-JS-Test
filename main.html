<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ecommerce Test</title>

    <script>

        /**
        * gets all Json Data from a server. 
        * returns {Dictionary} - all sites
        */
        const getFromJsonServer = async()=>{
            let response = await fetch('./sites.json')
            let data = await response.json()
                if (response.status===200){return data}
                else{
                    alert(`${response.status}: ${response.statusText}`)
                    return null      
                    }
        }

        const colorListForBG =['#add8e6','#87ceeb', '#c0c0c0', '#f4a460']


        /**
        * Makes individual div for each site. If subdata exists, loops through it in a recusrive manner and appends the div with subdata divs
        */
        const HandleData = (list, bgColorNum, id) => {
            

            list.forEach((subItem)=>{
                const siteDiv = document.createElement("div")

                siteDiv.setAttribute('id', subItem.id)
                siteDiv.setAttribute('style',`border-radius: 10px;border: 2px solid green;padding: 10px; background-color:${colorListForBG[bgColorNum]}`)
                siteDiv.setAttribute('class', 'site box')

                siteDiv.innerHTML = `
    
                                            <div class="site-info">
                                                <p class="id p">id: ${subItem.id}</p>
                                                <p class="name p">Site Name: ${subItem.name}</p>
                                                <p class="anchor p"><a href="${subItem.url}" target="_blank">${subItem.name}</a></p>
                                            </div>
                                        `;

                if (id){
                    document.getElementbyId(String(id)).appendChild(siteDiv)
                }
                else{main.appendChild(siteDiv)}
                console.log(subItem.subData)

            
                if (subItem.hasOwnProperty(subData)){
                    HandleData(subItem.subData, (bgColorNum+1), subItem.id)
                } 
                console.log(`finished div #${subItem.id}`)
            })
            console.log('finished all')
        }

        
        /////////////////////////////////////////////////////////////////////


        const theData = getFromJsonServer()
        if (theData){
            HandleData(theData, 0, null)
        }
        

    </script>
</head>







<body>
    
</body>
</html>